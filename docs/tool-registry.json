{
  "version": "1.0",
  "policy": {
    "passive_only": true,
    "notes": "Tools are observational and non-intrusive. No exploits or active probing."
  },
  "tools": [
    {
      "name": "camera.viewer",
      "scope": "camera",
      "kind": "passive",
      "description": "Compose a viewer URL for a device camera endpoint.",
      "input": "ip (required), path (optional)",
      "output": "url",
      "output_schema": {"url": "string"}
    },
    {
      "name": "net.arp",
      "scope": "network",
      "kind": "passive",
      "description": "Read local ARP cache entries.",
      "input": "none",
      "output": "entries",
      "output_schema": {"lines": "string[]"}
    },
    {
      "name": "net.status_snapshot",
      "scope": "network",
      "kind": "passive",
      "description": "Capture Wi-Fi and interface status (no changes).",
      "input": "interface (optional, default en0)",
      "output": "network snapshot",
      "output_schema": {"wifi": "string", "ifconfig": "string"}
    },
    {
      "name": "net.dhcp_packet",
      "scope": "network",
      "kind": "passive",
      "description": "Read the last DHCP packet for an interface.",
      "input": "interface (required)",
      "output": "dhcp packet info",
      "output_schema": {"packet": "string"}
    },
    {
      "name": "net.dns_timing",
      "scope": "network",
      "kind": "passive",
      "description": "Measure DNS lookup time for a hostname.",
      "input": "hostname (required)",
      "output": "resolution ms + addresses",
      "output_schema": {"ms": "number", "addrs": "string[]"}
    },
    {
      "name": "net.wifi_scan",
      "scope": "network",
      "kind": "passive",
      "description": "Scan nearby Wi-Fi SSIDs (macOS airport helper).",
      "input": "pattern (optional regex)",
      "output": "scan output",
      "output_schema": {"lines": "string[]"}
    },
    {
      "name": "net.whoami_rollcall",
      "scope": "network",
      "kind": "passive",
      "description": "Enumerate /whoami responses for reachable hosts.",
      "input": "ip_list (optional CSV), timeout_ms (optional)",
      "output": "whoami responses",
      "output_schema": {"results": "object"}
    },
    {
      "name": "portal.flash_targets",
      "scope": "portal",
      "kind": "passive",
      "description": "Fetch station flash targets for portal devices.",
      "input": "station_url (required)",
      "output": "flash targets",
      "output_schema": {"items": "object[]"}
    },
    {
      "name": "p4.status",
      "scope": "p4",
      "kind": "passive",
      "description": "Fetch ESP32-P4 God Button status.",
      "input": "ip (required)",
      "output": "p4 status",
      "output_schema": {"node_id": "string", "state": "object"}
    },
    {
      "name": "p4.god",
      "scope": "p4",
      "kind": "passive",
      "description": "Trigger ESP32-P4 God Button actions.",
      "input": "ip (required)",
      "output": "p4 action summary",
      "output_schema": {"ok": "boolean", "details": "object"}
    },
    {
      "name": "station.portal_state",
      "scope": "station",
      "kind": "passive",
      "description": "Fetch the station portal state snapshot.",
      "input": "station_url (optional)",
      "output": "portal state",
      "output_schema": {"station": "object", "logger": "object", "nodes": "object"}
    },
    {
      "name": "station.frames_health",
      "scope": "station",
      "kind": "passive",
      "description": "Summarize frames count by source.",
      "input": "station_url (optional)",
      "output": "frames summary",
      "output_schema": {"frames": "number", "by_source": "object"}
    },
    {
      "name": "ble.scan_snapshot",
      "scope": "ble",
      "kind": "passive",
      "description": "Summarize BLE sightings in the recent event window.",
      "input": "window_ms (optional)",
      "output": "ble snapshot",
      "output_schema": {"items": "object[]"}
    },
    {
      "name": "ble.rssi_trend",
      "scope": "ble",
      "kind": "passive",
      "description": "Summarize recent RSSI values for a device.",
      "input": "device_id (optional)",
      "output": "recent RSSI trend",
      "output_schema": {"points": "string[]"}
    },
    {
      "name": "events.activity_snapshot",
      "scope": "events",
      "kind": "passive",
      "description": "Summarize events by kind and node.",
      "input": "window_s (optional)",
      "output": "event summary",
      "output_schema": {"by_kind": "object", "by_node": "object"}
    },
    {
      "name": "events.replay",
      "scope": "automation",
      "kind": "passive",
      "description": "Validate an NDJSON file for replay.",
      "input": "path (required)",
      "output": "replay status",
      "output_schema": {"path": "string", "status": "string"}
    }
  ]
}
